Codes for Figure 5
